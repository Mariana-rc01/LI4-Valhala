@page "/"
@using System.Security.Claims
@using Valhala.Authentication
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider
@using MudBlazor
@using Valhala.Controller.Data
@using Microsoft.AspNetCore.Components
@using Valhala.Controller.UI
@using Valhala.Controller.Products

@inject NavigationManager NavManager

<PageTitle>Catálogo</PageTitle>

<h1>Catálogo para o Dionisio meter bonito (Mariana - queria testar a visualização do produto sem login)</h1>

<MudContainer MaxWidth="MaxWidth.Large">
    <MudGrid>
        @foreach (var produto in Produtos)
        {
            <MudItem xs="12" sm="6" md="4">
                <MudCard>
                    <MudCardMedia Image="@produto.GetImagem()" Alt="Imagem do produto" Height="200"/>
                    <MudCardContent>
                        <MudText Typo="Typo.h6">@produto.GetNome()</MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="() => VerDetalhes(produto.GetID())">
                            Ver Detalhes
                        </MudButton>
                    </MudCardActions>
                </MudCard>
            </MudItem>
        }
    </MudGrid>
</MudContainer>

@code {
    private List<Produto> Produtos = new List<Produto>();

    protected override void OnInitialized()
    {
        Produtos = ProdutoDAO.GetInstance().ListarProdutos();
    }

    private void VerDetalhes(int id)
    {
        NavManager.NavigateTo($"/produto/{id}");
    }
}